\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{beamerthemeUCAS}[2018/04/17]
\mode<presentation>
\RequirePackage{etoolbox}
\DeclareOptionBeamer{locale}{\def\ucasbeamer@option@locale{#1}}
\ExecuteOptionsBeamer{locale={%
  \@ifundefined{languagename}{english}{\languagename}}}
\DeclareOptionBeamer{workplace}{\def\ucasbeamer@option@workplace{#1}}
\ExecuteOptionsBeamer{workplace=ucas}
\newif\ifucasbeamer@option@fonts
\newif\ifucasbeamer@option@scaling
\def\ucasbeamer@temp@option@fonts@none{none}
\def\ucasbeamer@temp@option@fonts@basic{basic}
\def\ucasbeamer@temp@option@fonts@scaled{scaled}
\DeclareOptionBeamer{fonts}{%
  \def\ucasbeamer@temp@option@arg{#1}%
  \ifx\ucasbeamer@temp@option@arg\ucasbeamer@temp@option@fonts@none
    \ucasbeamer@option@fontsfalse
    \ucasbeamer@option@scalingfalse
  \else
    \ifx\ucasbeamer@temp@option@arg\ucasbeamer@temp@option@fonts@basic
      \ucasbeamer@option@fontstrue
      \ucasbeamer@option@scalingfalse
    \else
      \ifx\ucasbeamer@temp@option@arg\ucasbeamer@temp@option@fonts@scaled
        \ucasbeamer@option@fontstrue
        \ucasbeamer@option@scalingtrue
      \else
        \PackageError{beamerthemeUCAS}%
          {fonts=#1 is not a valid option}%
          {fonts={none|basic|scaled} are the only valid options}%
      \fi
    \fi
  \fi
}
\ExecuteOptionsBeamer{fonts=scaled}
\ProcessOptionsBeamer
\ifucasbeamer@option@scaling
  \RequirePackage{PTSansCaption}
  \@ifpackageloaded{fontspec}{
    \newfontfamily\ucasbeamer@temp@fontname
      [NFSSFamily=PTSansCaption-TLF]{PT Sans Caption}
  }{}
\fi
\def\ucasbeamer@option@locale@logo{\ucasbeamer@option@locale}
\def\ucasbeamer@option@locale@label{\ucasbeamer@option@locale}
\def\ucasbeamer@pathname@base{ucasbeamer/}
\def\ucasbeamer@pathname@logo{\ucasbeamer@pathname@base logo/}
\def\ucasbeamer@pathname@label{\ucasbeamer@pathname@base label/}
\def\ucasbeamer@filename@logo{%
  \ucasbeamer@pathname@logo ucasbeamer-\ucasbeamer@option@workplace-%
    \ucasbeamer@option@locale@logo
    }
\def\ucasbeamer@filename@logo@fallback{%
  \ucasbeamer@pathname@logo ucasbeamer-\ucasbeamer@option@workplace-english%
    }
\def\ucasbeamer@filename@logo@lastresort{%
  \ucasbeamer@pathname@logo ucasbeamer%
    }
\def\ucasbeamer@filename@label{%
  \ucasbeamer@pathname@label ucasbeamer-\ucasbeamer@option@workplace-%
    \ucasbeamer@option@locale@label
    }
\def\ucasbeamer@filename@label@fallback{%
  \ucasbeamer@pathname@label ucasbeamer-\ucasbeamer@option@workplace%
    }
\newcount\ucasbeamer@temp@recursion
\newcommand*\ucasbeamer@subroutine@includegraphics[4][]{%
  \begingroup
  \ucasbeamer@temp@recursion=0
  \patchcmd{\Gin@ii}{\Gin@esetsize}{%
    \renewcommand{\@latex@error}[2]{%
      \ifnum\ucasbeamer@temp@recursion<2
        \advance\ucasbeamer@temp@recursion by 1
        \ifnum\ucasbeamer@temp@recursion=1
          \includegraphics[#1]{#3}
        \else
          \if\empty#4\empty
            \PackageError{beamerthemeUCAS}%
              {none of the following graphics files was found: #2, #3}%
              {check that the ucasbeamer package has been correctly
               installed\MessageBreak and that you specified an existing
               workplace}%
          \else
            \includegraphics[#1]{#4}
          \fi
        \fi
      \else
        \PackageError{beamerthemeUCAS}%
          {none of the following graphics files was found: #2, #3, #4}%
          {check that the ucasbeamer package has been correctly
           installed\MessageBreak and that you specified an existing
           workplace}%
      \fi}%
    \Gin@esetsize}{}{%
      \PackageError{beamerthemeUCAS}%
        {unable to patch the includegraphics command}%
        {contact the maintainer of the package}}%
  \includegraphics[#1]{#2}%
  \endgroup}
\def\ucasbeamer@pathname@patch{\ucasbeamer@pathname@base patch/}
\def\ucasbeamer@filename@patch{%
  \ucasbeamer@pathname@patch ucasbeamer-\ucasbeamer@option@workplace}
\newlength\ucasbeamer@length@margin
\ucasbeamer@length@margin=0.7cm
\newlength\ucasbeamer@length@toppadding
\ucasbeamer@length@toppadding=28pt
\newlength\ucasbeamer@length@footlinebottompadding
\ucasbeamer@length@footlinebottompadding=.163cm
\newlength\ucasbeamer@length@logotopmargin
\ucasbeamer@length@logotopmargin=\ucasbeamer@length@margin
\newlength\ucasbeamer@length@footlineheight
\ucasbeamer@length@footlineheight=.4cm
\newlength\ucasbeamer@length@labelwidth@titlepage
\newlength\ucasbeamer@length@labelheight@titlepage
\ucasbeamer@length@labelwidth@titlepage=3.5cm
\ucasbeamer@length@labelheight@titlepage=1.4cm
\newlength\ucasbeamer@length@labelwidth
\newlength\ucasbeamer@length@labelheight
\ucasbeamer@length@labelwidth=2.7cm
\ucasbeamer@length@labelheight=1.08cm
\newlength\ucasbeamer@length@logomaxwidth
\newlength\ucasbeamer@length@logomaxheight
\ucasbeamer@length@logomaxwidth=3cm
\ucasbeamer@length@logomaxheight=1.5cm
\definecolor{ucasbeamer@base}{RGB}{0,39,118}
\definecolor{ucasbeamer@gray1}{RGB}{240,240,240}
\definecolor{ucasbeamer@gray2}{RGB}{225,225,225}
\definecolor{ucasbeamer@gray3}{RGB}{210,210,210}
\definecolor{ucasbeamer@gray4}{RGB}{190,190,190}
\definecolor{ucasbeamer@gray5}{RGB}{170,170,170}
\definecolor{ucasbeamer@gray6}{RGB}{150,150,150}
\definecolor{ucasbeamer@gray7}{RGB}{130,130,130}
\definecolor{ucasbeamer@orange1}{RGB}{245,165,0}
\definecolor{ucasbeamer@orange2}{RGB}{240,140,0}
\definecolor{ucasbeamer@law}{RGB}{128,55,155}
\definecolor{ucasbeamer@med}{RGB}{240,25,40}
\definecolor{ucasbeamer@sci}{RGB}{0,175,63}
\definecolor{ucasbeamer@phil}{RGB}{0,161,222}
\definecolor{ucasbeamer@ped}{RGB}{255,160,47}
\definecolor{ucasbeamer@econ}{RGB}{120,35,39}
\definecolor{ucasbeamer@fi}{RGB}{252,212,80}
\definecolor{ucasbeamer@fss}{RGB}{0,123,105}
\definecolor{ucasbeamer@fsps}{RGB}{0,154,166}
\useoutertheme{infolines}
\setbeamersize{%
  text margin left=\ucasbeamer@length@margin,
  text margin right=\ucasbeamer@length@margin}
\setbeamertemplate{background canvas}{%
  \ifnum\value{page}=1
    \let\ucasbeamer@temp@length\ucasbeamer@length@labelheight@titlepage
  \else
    \let\ucasbeamer@temp@length\ucasbeamer@length@labelheight
  \fi
  \leavevmode\hskip\ucasbeamer@length@margin
  \ucasbeamer@subroutine@includegraphics%
    [height=\ucasbeamer@temp@length]%
    {\ucasbeamer@filename@label}%
    {\ucasbeamer@filename@label@fallback}{}}
\setbeamertemplate{frametitle}{%
  \vskip\ucasbeamer@length@toppadding
  \vtop{{%
      \usebeamerfont{frametitle}{\insertframetitle}%
      \ifx\insertframesubtitle\@empty\else\\
        \usebeamerfont{framesubtitle}{\insertframesubtitle}
      \fi}
    \vfill}}
\setbeamertemplate{navigation symbols}{}
\setbeamertemplate{footline}{%
  \hskip\ucasbeamer@length@margin
  \usebeamercolor[fg]{author in head/foot}%
    \usebeamerfont{author in head/foot}\insertshortauthor
  \ \lower2pt\hbox{\Large$\cdot$}\
  \usebeamercolor[fg]{title in head/foot}%
    \usebeamerfont{title in head/foot}\insertshorttitle
  \ \lower2pt\hbox{\Large$\cdot$}\
  \usebeamercolor[fg]{date in head/foot}%
    \usebeamerfont{date in head/foot}\insertshortdate
  \hfill
  \insertframenumber{} / \inserttotalframenumber
  \hskip\ucasbeamer@length@margin
  \vrule width 0pt height \ucasbeamer@length@footlineheight
         depth \ucasbeamer@length@footlinebottompadding}
\setbeamertemplate{title page}{%
  \vskip0pt plus 1filll
  {\usebeamerfont{title}\usebeamercolor[fg]{title}\inserttitle}%
    \medskip

  {\usebeamerfont{subtitle}\usebeamercolor[fg]{subtitle}\insertsubtitle}%
    \bigskip

  {\usebeamerfont{author} \insertauthor}%
    \medskip

  {\usebeamerfont{date} \insertdate}%
  \vskip\ucasbeamer@length@logotopmargin
  \ucasbeamer@subroutine@includegraphics%
    [
      width=\ucasbeamer@length@logomaxwidth,
      height=\ucasbeamer@length@logomaxheight,
      keepaspectratio
    ]%
    {\ucasbeamer@filename@logo}%
    {\ucasbeamer@filename@logo@fallback}%
    {\ucasbeamer@filename@logo@lastresort}
  \vskip\ucasbeamer@length@margin}
\setbeamertemplate{bibliography item}[text]
\setbeamertemplate{itemize items}[square]
\setbeamertemplate{blocks}[rounded][shadow=true]
\setbeamerfont{structure}{series=\bfseries}
\setbeamercolor{structure}{fg=ucasbeamer@gray6}

\setbeamerfont{alerted text}{series=\bfseries}
\setbeamercolor{alerted text}{fg=ucasbeamer@orange2}

\setbeamerfont{title}{size=\Large,series=\bfseries}
\setbeamercolor{title}{fg=ucasbeamer@base}
\setbeamerfont{title in head/foot}{size=\tiny,series=\bfseries}
\setbeamercolor{title in head/foot}{parent=structure}

\setbeamerfont{author}{series=\bfseries,size=\small}
\setbeamerfont{author in head/foot}{size=\tiny,series=\bfseries}
\setbeamercolor{author in head/foot}{parent=structure}

\setbeamerfont{date}{size=\footnotesize}
\setbeamerfont{date in head/foot}{size=\tiny,series=\bfseries}
\setbeamercolor{date in head/foot}{parent=structure}

\setbeamerfont{frametitle}{series=\bfseries,size=\Large}
\setbeamercolor{frametitle}{parent=title}

\setbeamerfont{framesubtitle}{series=\bfseries,size=\large}
\setbeamercolor{framesubtitle}{parent=subtitle}

\setbeamercolor{bibliography entry author}{%
  use=normal text,fg=normal text.fg}
\setbeamercolor{bibliography entry title}{%
  use=normal text,fg=normal text.fg}
\setbeamercolor{bibliography entry location}{%
  use=normal text,fg=normal text.fg}
\setbeamercolor{bibliography entry note}{%
  use=normal text,fg=normal text.fg}

\setbeamerfont{footnote}{size=\footnotesize}
\setbeamercolor{footnote mark}{parent=structure}

\setbeamerfont{section in head/foot}{parent=structure}
\setbeamercolor{section in head/foot}{parent=structure}

\setbeamerfont{subsection in head/foot}{parent=normal text}
\setbeamercolor{subsection in head/foot}{parent=structure}

\setbeamercolor{block title}{fg=white,bg=ucasbeamer@base}
\setbeamercolor{block title example}{%
  use=alerted text,fg=white,bg=ucasbeamer@gray7}
\setbeamercolor{block title alerted}{%
  use=alerted text,fg=white,bg=ucasbeamer@orange1}

\setbeamercolor{block body}{%
  parent=normal text,use=block title,
  bg=block title.bg!10!bg}
\setbeamercolor{block body example}{%
  parent=normal text,bg=ucasbeamer@gray1}
\setbeamercolor{block body alerted}{%
  parent=normal text,use=block title alerted,
  bg=block title alerted.bg!10!bg}
\IfFileExists{\ucasbeamer@filename@patch.sty}{%
  \RequirePackage{\ucasbeamer@filename@patch}}{}
\mode
  <all>
\endinput
